<div class="product-detail-page">
  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <div class="spinner"></div>
    <p>Loading product details...</p>
  </div>

  <!-- Product Content -->
  <div *ngIf="!isLoading && product" class="product-content">
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
      <a routerLink="/">Home</a>
      <span class="separator">›</span>
      <a routerLink="/products">Products</a>
      <span class="separator">›</span>
      <span class="current">{{ product.name }}</span>
    </nav>

    <!-- Back Button (Mobile) -->
    <button class="back-btn hide-desktop" (click)="goBack()">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path d="M19 12H5M12 19l-7-7 7-7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
      Back to Products
    </button>

    <!-- Main Product Section -->
    <div class="product-main">
      <!-- Image Gallery -->
      <div class="product-gallery">
        <div class="main-image">
          <img [src]="selectedImage" [alt]="product.name" />
          <div class="product-badges">
            <span *ngIf="product.discount" class="badge discount-badge">-{{ product.discount }}%</span>
            <span *ngIf="product.isOrganic" class="badge organic-badge">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              Organic
            </span>
            <span *ngIf="product.isSeasonal" class="badge seasonal-badge">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2" stroke-width="2"/>
              </svg>
              Seasonal
            </span>
          </div>
        </div>
        <div class="thumbnail-images">
          <div *ngFor="let image of product.images" 
               class="thumbnail" 
               [class.active]="selectedImage === image"
               (click)="selectImage(image)">
            <img [src]="image" [alt]="product.name" />
          </div>
        </div>
      </div>

      <!-- Product Info -->
      <div class="product-info">
        <div class="product-header">
          <div class="category-badge">{{ product.category }}</div>
          <h1 class="product-title">{{ product.name }}</h1>
          <div class="product-meta">
            <div class="rating">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="#fbbf24" stroke="#fbbf24">
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
              </svg>
              <span class="rating-value">{{ product.rating }}</span>
              <span class="reviews">({{ product.reviewCount }} reviews)</span>
            </div>
            <div class="stock-status" [class.in-stock]="product.inStock">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <polyline points="20 6 9 17 4 12" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              {{ product.inStock ? 'In Stock' : 'Out of Stock' }}
            </div>
          </div>
        </div>

        <!-- Pricing -->
        <div class="pricing-section">
          <div class="price-main">
            <span class="current-price">₹{{ product.price }}</span>
            <span *ngIf="product.originalPrice" class="original-price">₹{{ product.originalPrice }}</span>
          </div>
          <div *ngIf="product.discount" class="savings">
            You save ₹{{ product.originalPrice! - product.price }} ({{ product.discount }}%)
          </div>
        </div>

        <!-- Product Tags -->
        <div class="product-tags">
          <span *ngFor="let tag of product.tags" class="tag">{{ tag }}</span>
        </div>

        <!-- Quantity Selector -->
        <div class="quantity-section">
          <label>Quantity ({{ product.unit }})</label>
          <div class="quantity-controls">
            <button class="qty-btn" (click)="decrementQuantity()" [disabled]="quantity <= 1">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <line x1="5" y1="12" x2="19" y2="12" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </button>
            <input type="number" [(ngModel)]="quantity" min="1" [max]="product.stockQuantity" class="qty-input" />
            <button class="qty-btn" (click)="incrementQuantity()" [disabled]="quantity >= product.stockQuantity">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <line x1="12" y1="5" x2="12" y2="19" stroke-width="2" stroke-linecap="round"/>
                <line x1="5" y1="12" x2="19" y2="12" stroke-width="2" stroke-linecap="round"/>
              </svg>
            </button>
          </div>
          <span class="stock-info">{{ product.stockQuantity }} {{ product.unit }} available</span>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
          <button class="btn-add-cart" (click)="addToCart()" [disabled]="!product.inStock">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <circle cx="9" cy="21" r="1" stroke-width="2"/>
              <circle cx="20" cy="21" r="1" stroke-width="2"/>
              <path d="M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Add to Cart
          </button>
          <button class="btn-buy-now" (click)="buyNow()" [disabled]="!product.inStock">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Buy Now
          </button>
        </div>

        <!-- Additional Info -->
        <div class="additional-info">
          <div class="info-item">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2M12 11a4 4 0 100-8 4 4 0 000 8z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <div>
              <strong>Farmer:</strong>
              <span>{{ product.farmerName }}</span>
            </div>
          </div>
          <div class="info-item">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              <circle cx="12" cy="10" r="3" stroke-width="2"/>
            </svg>
            <div>
              <strong>Origin:</strong>
              <span>{{ product.origin }}</span>
            </div>
          </div>
          <div class="info-item" *ngIf="product.shelfLife">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <circle cx="12" cy="12" r="10" stroke-width="2"/>
              <polyline points="12 6 12 12 16 14" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <div>
              <strong>Shelf Life:</strong>
              <span>{{ product.shelfLife }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Product Details Tabs -->
    <div class="product-details-section">
      <div class="tabs-header">
        <button class="tab-btn" 
                [class.active]="selectedTab === 'description'"
                (click)="selectTab('description')">
          Description
        </button>
        <button class="tab-btn" 
                [class.active]="selectedTab === 'nutrition'"
                (click)="selectTab('nutrition')"
                *ngIf="product.nutritionInfo">
          Nutrition Facts
        </button>
        <button class="tab-btn" 
                [class.active]="selectedTab === 'reviews'"
                (click)="selectTab('reviews')">
          Reviews ({{ product.reviewCount }})
        </button>
      </div>

      <div class="tabs-content">
        <!-- Description Tab -->
        <div *ngIf="selectedTab === 'description'" class="tab-panel">
          <h3>About this product</h3>
          <p>{{ product.description }}</p>
        </div>

        <!-- Nutrition Tab -->
        <div *ngIf="selectedTab === 'nutrition' && product.nutritionInfo" class="tab-panel">
          <h3>Nutrition Information</h3>
          <div class="nutrition-grid">
            <div class="nutrition-item">
              <span class="label">Calories</span>
              <span class="value">{{ product.nutritionInfo.calories }} kcal</span>
            </div>
            <div class="nutrition-item">
              <span class="label">Protein</span>
              <span class="value">{{ product.nutritionInfo.protein }}</span>
            </div>
            <div class="nutrition-item">
              <span class="label">Carbohydrates</span>
              <span class="value">{{ product.nutritionInfo.carbs }}</span>
            </div>
            <div class="nutrition-item">
              <span class="label">Fat</span>
              <span class="value">{{ product.nutritionInfo.fat }}</span>
            </div>
            <div class="nutrition-item">
              <span class="label">Fiber</span>
              <span class="value">{{ product.nutritionInfo.fiber }}</span>
            </div>
          </div>
        </div>

        <!-- Reviews Tab -->
        <div *ngIf="selectedTab === 'reviews'" class="tab-panel">
          <h3>Customer Reviews</h3>
          <p class="coming-soon">Reviews section coming soon...</p>
        </div>
      </div>
    </div>

    <!-- Related Products -->
    <div class="related-products-section" *ngIf="relatedProducts.length > 0">
      <h2 class="section-title">You May Also Like</h2>
      <div class="related-products-grid">
        <div *ngFor="let relatedProduct of relatedProducts" class="related-product-card">
          <div class="product-image">
            <img [src]="relatedProduct.images[0]" [alt]="relatedProduct.name" />
          </div>
          <div class="product-info">
            <h4>{{ relatedProduct.name }}</h4>
            <div class="price">₹{{ relatedProduct.price }}</div>
            <button class="btn-view" [routerLink]="['/products', relatedProduct.id]">View Details</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
